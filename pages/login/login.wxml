<!--pages/login/login.wxml-->
<view class="container">
  <!-- 头部Logo区域 -->
  <view class="header">
    <view class="logo">
      <text class="logo-icon">📝</text>
      <text class="logo-text">语寄心声</text>
    </view>
    <text class="subtitle">记录生活，连接思想</text>
  </view>

  <!-- 账号登录 -->
  <view class="login-card">
    <view class="card-header">
      <text class="welcome-text">账号登录</text>
      <text class="welcome-desc">使用邮箱和密码登录</text>
    </view>
    <view class="input-group">
      <view class="input-item">
        <text class="input-label">邮箱地址</text>
        <input class="input-field"
               placeholder="请输入已注册的邮箱地址"
               value="{{loginEmail}}"
               bindinput="onLoginEmailInput"
               type="email"/>
        <view class="input-hint {{loginEmailError ? 'error' : ''}}">
          <text wx:if="{{loginEmailError}}">{{loginEmailError}}</text>
          <text wx:else>输入您注册时使用的邮箱地址</text>
        </view>
      </view>
      <view class="input-item">
        <text class="input-label">密码</text>
        <view class="password-input">
          <input class="input-field password-field"
                 placeholder="请输入密码"
                 value="{{loginPassword}}"
                 bindinput="onLoginPasswordInput"
                 password="{{!showPassword}}"
                 type="text"/>
          <view class="password-toggle" bindtap="togglePasswordVisibility">
            <text class="toggle-icon">{{showPassword ? '👁️' : '🙈'}}</text>
          </view>
        </view>
        <view class="input-hint {{loginPasswordError ? 'error' : ''}}">
          <text wx:if="{{loginPasswordError}}">{{loginPasswordError}}</text>
          <text wx:else>输入您的登录密码</text>
        </view>
      </view>
    </view>

    <!-- 记住密码选项 -->
    <view class="remember-password">
      <checkbox-group bindchange="onRememberPasswordChange">
        <label class="remember-label">
          <checkbox value="remember" checked="{{rememberPassword}}"/>
          <text class="remember-text">记住登录信息</text>
        </label>
      </checkbox-group>
      <text class="remember-hint">仅在本设备有效，跨设备需重新登录</text>
    </view>

    <button class="login-btn"
            bindtap="loginWithPassword"
            disabled="{{!loginEmail || !loginPassword || logging}}">
      {{logging ? '登录中...' : '登录'}}
    </button>
  </view>

  <!-- 创建新账户 -->
  <view class="login-card">
    <view class="card-header">
      <text class="welcome-text">还没有账户？</text>
      <text class="welcome-desc">首次使用请完成注册并配置Notion</text>
    </view>
    <button class="register-guide-btn" bindtap="goToRegister">
      <view class="btn-content">
        <text class="btn-icon">✨</text>
        <view class="btn-text">
          <text class="btn-title">立即注册</text>
          <text class="btn-desc">包含完整的Notion配置向导</text>
        </view>
      </view>
    </button>
  </view>

  <!-- 底部说明 -->
  <view class="footer">
    <text class="footer-text">🔐 每个微信账号的数据完全隔离</text>
    <text class="footer-text">📱 同一微信账号只需登录一次</text>
  </view>
</view>

<!-- 加载遮罩 -->
<view class="loading-mask" wx:if="{{logging}}">
  <view class="loading-content">
    <view class="loading-spinner"></view>
    <text>正在登录...</text>
  </view>
</view>