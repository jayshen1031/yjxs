<view class="container">
  <!-- æ—¶é—´çº¿æ ‡é¢˜ -->
  <view class="timeline-header">
    <view class="timeline-title">ğŸ“ å®æ—¶æ—¶é—´çº¿</view>
    <view class="timeline-desc">æœ€è¿‘30æ¡è®°å½•çš„æ—¶é—´è½´å±•ç¤º</view>
  </view>

  <!-- ç®€åŒ–ç­›é€‰ -->
  <view class="filter-section">
    <view class="search-box">
      <input 
        class="search-input"
        placeholder="å¿«é€Ÿæœç´¢..."
        value="{{ searchKeyword }}"
        bindinput="onSearchInput"
        bindconfirm="onSearch"
      />
      <text class="search-icon">ğŸ”</text>
    </view>
    
    <!-- ç®€åŒ–ç­›é€‰æ ‡ç­¾ -->
    <view class="filter-tabs">
      <view 
        class="filter-tab {{ activeFilter === 'all' ? 'active' : '' }}"
        bindtap="setFilter" 
        data-filter="all"
      >
        å…¨éƒ¨
      </view>
      <view 
        class="filter-tab {{ activeFilter === 'today' ? 'active' : '' }}"
        bindtap="setFilter" 
        data-filter="today"
      >
        ä»Šå¤©
      </view>
      <view 
        class="filter-tab {{ activeFilter === 'voice' ? 'active' : '' }}"
        bindtap="setFilter" 
        data-filter="voice"
      >
        è¯­éŸ³
      </view>
    </view>
  </view>

  <!-- æ—¶é—´çº¿åˆ—è¡¨ -->
  <view class="timeline-list" wx:if="{{ filteredMemos.length > 0 }}">
    <view class="timeline-item fade-in" wx:for="{{ filteredMemos }}" wx:key="id">
      <!-- æ—¶é—´çº¿èŠ‚ç‚¹ -->
      <view class="timeline-node">
        <view class="timeline-dot {{ item.isPlanning ? 'planning' : item.type }}"></view>
        <view class="timeline-line" wx:if="{{ index < filteredMemos.length - 1 }}"></view>
      </view>
      
      <!-- è®°å½•å†…å®¹ -->
      <view class="timeline-content">
        <view class="memo-card {{ item.isPlanning ? 'planning-card' : '' }}" bindtap="viewMemoDetail" data-memo="{{ item }}">
          <!-- æ—¶é—´ä¿¡æ¯ -->
          <view class="memo-time">
            <text class="time-main">{{ item.timeDisplay.time }}</text>
            <text class="time-date">{{ item.timeDisplay.date }}</text>
          </view>
          
          <!-- å†…å®¹é¢„è§ˆ -->
          <view class="memo-preview">
            <text class="memo-text">{{ item.content }}</text>
          </view>
          
          <!-- æ ‡ç­¾å’Œç±»å‹ -->
          <view class="memo-meta">
            <view class="memo-labels">
              <text class="tag period-{{ item.periodColor }}">{{ item.timePeriod }}</text>
              <text class="tag category-{{ item.categoryColor }}">{{ item.category }}</text>
              <text class="tag {{ item.isPlanning ? 'planning' : item.type }}">
                {{ item.isPlanning ? 'è§„åˆ’' : (item.type === 'voice' ? 'è¯­éŸ³' : 'æ–‡å­—') }}
              </text>
            </view>
            <view class="memo-tags" wx:if="{{ item.tags && item.tags.length > 0 }}">
              <text class="tag user-tag" wx:for="{{ item.tags }}" wx:key="index" wx:for-item="tag">{{ tag }}</text>
            </view>
          </view>
          
          <!-- æ“ä½œæŒ‰é’® -->
          <view class="memo-actions">
            <button class="action-btn" wx:if="{{ item.type === 'voice' }}" catchtap="playVoice" data-memo="{{ item }}">
              <text>{{ item.isPlaying ? 'â¸ï¸' : 'â–¶ï¸' }}</text>
            </button>
            <button class="action-btn" catchtap="editMemo" data-memo="{{ item }}">
              <text>âœï¸</text>
            </button>
            <button class="action-btn delete" catchtap="deleteMemo" data-memo="{{ item }}">
              <text>ğŸ—‘ï¸</text>
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:else class="empty-state">
    <view class="empty-icon">ğŸ“</view>
    <view class="empty-text">
      <text wx:if="{{ searchKeyword }}">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³è®°å½•</text>
      <text wx:else>æš‚æ— è®°å½•ï¼Œå¼€å§‹è®°å½•ç¾å¥½ç”Ÿæ´»å§ï¼</text>
    </view>
    <button wx:if="{{ !searchKeyword }}" class="btn btn-primary" bindtap="goToAddMemo">
      <text>å¼€å§‹è®°å½•</text>
    </button>
  </view>

  <!-- æŸ¥çœ‹æ›´å¤šæŒ‰é’® -->
  <view class="more-actions" wx:if="{{ filteredMemos.length >= 30 }}">
    <button class="btn btn-secondary view-more-btn" bindtap="goToHistory">
      <text>ğŸ“š æŸ¥çœ‹å®Œæ•´å†å²è®°å½•</text>
    </button>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-footer" wx:if="{{ filteredMemos.length > 0 }}">
    <text class="stats-text">æ˜¾ç¤ºæœ€è¿‘ {{ filteredMemos.length }} æ¡è®°å½•</text>
  </view>
</view>

<!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
<view class="fab" bindtap="goToAddMemo">
  <text>+</text>
</view>