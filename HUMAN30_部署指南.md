# HUMAN 3.0 评估系统 - 部署和测试指南

## 📦 已完成的功能

✅ 评估引导页面
✅ 对话式评估界面
✅ Azure OpenAI集成
✅ 首页入口卡片
✅ 云函数代码

## 🚀 部署步骤

### 第一步：上传云函数

1. **打开微信开发者工具**
2. **找到云函数目录**
   - 展开左侧文件树
   - 找到 `cloudfunctions/human30-assessment`

3. **右键点击文件夹**
   - 选择 **"上传并部署：云端安装依赖"**
   - 这会自动安装axios等依赖包

4. **等待部署完成**
   - 看到"上传成功"提示即可（约1-2分钟）

### 第二步：验证云函数

1. **打开云开发控制台**
   - 点击开发者工具顶部的"云开发"按钮
   - 进入"云函数"标签

2. **找到human30-assessment**
   - 查看状态是否为"部署成功"
   - 查看版本号和更新时间

3. **测试云函数**（可选）
   - 点击右侧的"测试"按钮
   - 输入以下测试数据：
   ```json
   {
     "action": "chat",
     "data": {
       "messages": [],
       "sessionId": "test_123"
     }
   }
   ```
   - 点击"运行测试"
   - 应该能看到AI的欢迎消息

### 第三步：创建数据库集合（可选）

云函数会自动创建，但也可以手动预先创建：

1. **进入云开发控制台 → 数据库**
2. **创建集合**：
   - `human30_sessions` - 存储评估会话
   - `human30_reports` - 存储评估报告

3. **设置权限**：
   - 选择"仅创建者可读写"

## 🧪 测试流程

### 1. 启动小程序

在微信开发者工具中：
- 点击"编译"按钮
- 等待小程序启动

### 2. 进入首页

应该能看到：
- 箴言卡片
- 今日价值统计
- **🧭 HUMAN 3.0 发展评估卡片** ⭐（新增）
- 今日开心推荐
- 其他卡片...

### 3. 开始评估

1. **点击HUMAN 3.0卡片**
   - 跳转到引导页

2. **阅读引导页**
   - 查看四象限说明
   - 查看评估时长（30-45分钟）
   - 查看评估建议

3. **点击"开始评估"**
   - 确认弹窗 → 点击"开始"
   - 跳转到评估对话页面

4. **回答AI问题**
   - AI会首先问候并问第一个问题（关于Mind象限）
   - 在输入框中详细回答
   - 点击"➡️ 提交答案"
   - AI会根据你的回答继续提问

5. **观察进度**
   - 顶部显示当前象限（🧠 Mind → 💪 Body → 🌟 Spirit → 💼 Vocation）
   - 进度条显示整体完成度
   - 问题计数（如：3/20）

### 4. 完成评估

- 回答约12-32个问题后
- AI会生成完整报告
- 跳转到报告页面（如果已实现）

### 5. 保存进度测试

1. 在评估过程中点击"💾 暂停保存"
2. 确认退出
3. 重新进入评估页面
4. 应该能继续之前的对话

## ⚠️ 常见问题排查

### 问题1：云函数调用失败

**现象**：点击"开始评估"后无响应或报错

**检查**：
1. 云函数是否部署成功？
   - 打开云开发控制台查看
2. 网络是否正常？
   - 检查开发者工具控制台的错误信息
3. API Key是否正确？
   - 查看 `cloudfunctions/human30-assessment/config.js`

**解决**：
```bash
# 重新部署云函数
右键 human30-assessment → 上传并部署：云端安装依赖
```

### 问题2：AI回复很慢或超时

**原因**：Azure OpenAI响应时间较长

**解决**：
1. 增加超时时间（已设置为60秒）
2. 检查Azure OpenAI配额是否充足
3. 换一个时间段测试（避开高峰期）

### 问题3：显示"未配置API密钥"

**检查**：
1. 打开 `cloudfunctions/human30-assessment/config.js`
2. 确认apiKey字段有值：
   ```javascript
   apiKey: '45288eb7fea64b628abb290a9505a709'
   ```
3. 重新上传云函数

### 问题4：首页看不到HUMAN 3.0卡片

**检查**：
1. 是否重新编译了？
2. 清除缓存重试：
   - 开发者工具 → 清除缓存 → 重新编译

## 📊 测试建议

### 最小测试（5分钟）

快速验证功能：
- 只回答每个象限2-3个问题
- 回答简短（1-2句话）
- 目的：验证流程是否通畅

### 完整测试（30-45分钟）

真实评估：
- 每个象限回答3-8个问题
- 详细回答（3-5句话）
- 目的：获得准确的评估报告

### 边界测试

- 测试暂停保存功能
- 测试长文本输入（500字以上）
- 测试网络中断恢复
- 测试多次重复评估

## 🎯 预期效果

### 对话示例

**AI**：
> 欢迎来到HUMAN 3.0发展评估。我将通过一系列问题来评估你在四个生活领域的发展水平。我会直接但尊重地说出真相——有时真相会刺痛，但清晰能加速成长。让我们从Mind象限开始。
>
> 请问：当你遇到一个与你世界观相矛盾的观点时，你的第一反应是什么？请详细描述你的思考过程。

**你**：
> 我通常会先感到不舒服，想要反驳。但我会强迫自己停下来，问自己：为什么我会有这种反应？这个观点背后的逻辑是什么？我有没有可能是错的？我会尝试从对方的角度思考，看看能否找到他们观点的合理之处。

**AI**：
> 很好，你展现了一定的元认知能力。你能意识到自己的情绪反应，并有意识地暂停判断。这是从Level 1向Level 2过渡的标志。
>
> 继续：你提到会"强迫自己停下来"——这个过程对你来说有多困难？是自然发生的还是需要很大的意志力？

### 进度显示

```
🧠 Mind 象限  [3/5]
████████░░░░░░░░ 40%
```

### 最终报告（示例）

```
YOUR METATYPE: The Curious Builder 🛠️

你是一个正在从个人优化转向系统建设的发展者。Mind已达Level 2.3，
展现出强大的思维能力和自我意识，但Spirit仍在Level 1.5，导致你
的成长缺乏深层意义感和社群支持...

YOUR LIFESTYLE ARCHETYPE: The Optimizer → The Integrated

当前你专注于个人提升，但缺乏与他人的深度连接和有意义的价值输出。
你的核心问题是：用自我优化逃避真实的关系建立和社会贡献...

🎯 Next 30 Days:
Daily Practice 1: 每天主动联系1个老朋友，不谈工作，只是闲聊...
```

## 📈 下一步开发

当前系统已完成：
- ✅ 评估引导页
- ✅ 对话式评估
- ✅ Azure OpenAI集成
- ✅ 首页入口

待开发功能：
- [ ] 评估报告展示页（详细的四象限分析）
- [ ] 历史评估记录页
- [ ] 一键生成待办计划（同步到待办库）
- [ ] Notion数据库保存评估结果
- [ ] 发展趋势图表

## 💬 反馈

测试过程中遇到任何问题，请记录：
1. 具体操作步骤
2. 报错信息（截图）
3. 控制台日志
4. 预期结果 vs 实际结果

---

**开发日期**：2025-01-11
**版本**：v1.0.0-beta
**基于框架**：HUMAN 3.0 by Dan Koe
